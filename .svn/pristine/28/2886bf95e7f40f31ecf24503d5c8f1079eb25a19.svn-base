<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn"%>
<style>
    #course-pills-tab {
        display: flex;
        justify-content: center; /* 전체 탭 리스트를 중앙 정렬 */
        width: 100%;
    }
    .orderItem {
        flex: 1; /* 모든 nav-item에 동일한 공간 할당 */
        display: flex;
        justify-content: center; /* 내부 요소 수평 중앙 정렬 */
        align-items: center; /* 내부 요소 수직 중앙 정렬 */
    }
    .orderLink {
        width: 100%; /* 버튼이 nav-item의 전체 너비를 차지하도록 */
        text-align: center; /* 버튼 텍스트 중앙 정렬 */
    }
</style>


<script>

	var xhr = new XMLHttpRequest();
	
	var recruitNo = "${apList[0].recruitNo}";
	var pstnCmmncdNm = "${apList[0].pstnCmmncdNm}";
	

	document.addEventListener("DOMContentLoaded", function(){
// 		console.log(recruitNo);
// 		console.log(pstnCmmncdNm);

		var orderClick = document.getElementById("course-pills-tab");
		orderClick.addEventListener("click", function(e){
			
// 			console.log("클릭함!!!");

			var orderNumber = e.target.innerText.split("차")[0].trim();
			var orderName =	e.target.innerText.split("차")[1].trim();
			
			console.log(orderName);
			console.log(orderNumber);
			
			if(orderName == "지원 접수"){
				
				getOrderContentByListName(recruitNo, pstnCmmncdNm, orderNumber);
				
			}
			if(orderName == "화상 면접"){
				
				
			}
			if(orderName == "Coding text"){
				
				
			}
			
		});
		
		fristTabinit();
		getTabList(recruitNo, pstnCmmncdNm);
		
	});
	
	
	
	//첫번째 탭 활성화 함수
	function fristTabinit() {
		
		var initTab = document.querySelectorAll(".first-tab-pane");
		var defaultTab = document.getElementById("course-pills-1");
		defaultTab.classList.add("show", "active");
		
	}
	
	//탭 리스트 활성화 함수
	function getTabList(recruitNo, pstnCmmncdNm) {
		
		xhr.open("GET", "getApplyProcessList?recruitNo="+encodeURIComponent(recruitNo)+"&pstnCmmncdNm="+encodeURIComponent(pstnCmmncdNm), true)
		
		xhr.onreadystatechange = function () {
			
			if(xhr.readyState === XMLHttpRequest.DONE){
				
				if(xhr.status === 200){
					
					var res = xhr.responseText;
// 					console.log(res);
					var parseRes = JSON.parse(res);
// 					console.log(parseRes);
					
					var orderListHTML = "";
					parseRes.forEach(function(list, index){
						
// 						console.log(list, index);
					
						if(index == 0){
							
							orderListHTML += 
								'<li class="nav-item orderItem" role="presentation">' +
					            	'<button class="nav-link mb-2 mb-md-0 orderLink active show" id="course-pills-tab-'+(index + 1)+'" data-bs-toggle="pill" data-bs-target="#course-pills-'+(index + 1)+'" type="button" role="tab" aria-controls="course-pills-'+(index + 1)+'" aria-selected="true">'+(index + 1)+'차 '+(list.clsNm)+'</button>'+
					        	'</li>'	;
							
						}else{
							
							orderListHTML += 
								'<li class="nav-item orderItem" role="presentation">' +
					            	'<button class="nav-link mb-2 mb-md-0 orderLink" id="course-pills-tab-'+(index + 1)+'" data-bs-toggle="pill" data-bs-target="#course-pills-'+(index + 1)+'" type="button" role="tab" aria-controls="course-pills-'+(index + 1)+'" aria-selected="true">'+(index + 1)+'차 '+(list.clsNm)+'</button>'+
					        	'</li>'	;
							
						}
						
					});
					var orderList = document.querySelector(".orderList");
					orderList.insertAdjacentHTML("beforeend", orderListHTML);
					
				}else{
					
					console.log("요청 실패");
				}
			}
		}
		xhr.send();
	}
	
	function getOrderContentByListName(recruitNo, pstnCmmncdNm, orderNumber) {
		
		xhr.open("GET", "getQstnDSNCTList?recruitNo="+encodeURIComponent(recruitNo)+"&pstnCmmncdNm="+encodeURIComponent(pstnCmmncdNm)"&orderNumber=" + encodeURIComponent(orderNumber), true)
		
		xhr.onreadystatechange = function () {
			
			if(xhr.readyState === XMLHttpRequest.DONE) {
				
				if(xhr.status === 200)	{
					
					console.log("연결성공");
					var res = xhr.responseText;
					var parseRes = JSON.parse(res);
					
					parseRes.forEach(function(res){
						
						console.log(res);
						
					});
					
					
				}else{
					
					console.log("연결실패");
					
				}			
				
			}
			
		}
		
		xhr.send()
		
	}
</script>

<div class="page-content-wrapper border">

	<!-- Title -->
	<div class="row mb-5">
		<div class="col-12 d-sm-flex justify-content-between align-items-center">
			<h1 class="h3 mb-2 mb-sm-0">${recruitTtl}</h1>
		</div>
	</div>
	
	<div class="card-header border-bottom mb-4">
	    <ul class="nav nav-bottom-line py-0 orderList" id="course-pills-tab" role="tablist">
	    
			<!-- 각 차수를 표시하는 목록  동적 AJAX -->
<!-- 	        <li class="nav-item orderItem" role="presentation"> -->
<!-- 	            <button class="nav-link mb-2 mb-md-0 orderLink active" id="course-pills-tab-1" data-bs-toggle="pill" data-bs-target="#course-pills-1" type="button" role="tab" aria-controls="course-pills-1" aria-selected="true">1차 지원 접수</button> -->
<!-- 	        </li> -->
	        
<!-- 	        <li class="nav-item orderItem" role="presentation"> -->
<!-- 	            <button class="nav-link mb-2 mb-md-0 orderLink" id="course-pills-tab-2" data-bs-toggle="pill" data-bs-target="#course-pills-2" type="button" role="tab" aria-controls="course-pills-2" aria-selected="false">2차 코딩 테스트</button> -->
<!-- 	        </li> -->
	        
<!-- 	        <li class="nav-item orderItem" role="presentation"> -->
<!-- 	            <button class="nav-link mb-2 mb-md-0 orderLink" id="course-pills-tab-3" data-bs-toggle="pill" data-bs-target="#course-pills-3" type="button" role="tab" aria-controls="course-pills-3" aria-selected="false">3차 화상 면접</button> -->
<!-- 	        </li> -->
	        
<!-- 	        <li class="nav-item orderItem" role="presentation"> -->
<!-- 	            <button class="nav-link mb-2 mb-md-0 orderLink" id="course-pills-tab-4" data-bs-toggle="pill" data-bs-target="#course-pills-4" type="button" role="tab" aria-controls="course-pills-4" aria-selected="false">4차 임원 면접</button> -->
<!-- 	        </li> -->
			<!--각 차수를 표시하는 목록 -->
	        
	    </ul>
	</div>
	<!-- 각 차수 마다 불러올 목록. 페이지를 로드 할때 활성화 init() 함수, 동적 AJAX-->
	<div class="first-tab-pane fade" id="course-pills-1" role="tabpanel" aria-labelledby="course-pills-tab-1">
		
		<div class="row">
			<div class="col-4 col-sm-3">
				<div class="nav flex-column nav-pills d-flex align-items-center justify-content-center" id="v-pills-tab" role="tablist" aria-orientation="vertical">
					<a class="nav-link active" id="v-pills-home-tab" data-bs-toggle="pill" href="#v-pills-home" role="tab" aria-controls="v-pills-home" style="width: 300px;" aria-selected="true">Home</a> 
					<a class="nav-link" id="v-pills-profile-tab" data-bs-toggle="pill" href="#v-pills-profile" role="tab" aria-controls="v-pills-profile" style="width: 300px;" aria-selected="false">Profile</a> 
					<a class="nav-link" id="v-pills-messages-tab" data-bs-toggle="pill" href="#v-pills-messages" role="tab" aria-controls="v-pills-messages" style="width: 300px;"aria-selected="false">Messages</a>
					<a class="nav-link" id="v-pills-settings-tab" data-bs-toggle="pill" href="#v-pills-settings" role="tab" aria-controls="v-pills-settings"  style="width: 300px;" aria-selected="false">Settings</a>
				</div>
			</div>
			<div class="col-8 col-sm-9">
				<div class="tab-content pt-0" id="v-pills-tabContent">
					<div class="tab-pane fade show active" id="v-pills-home" role="tabpanel" aria-labelledby="v-pills-home-tab">We have a strong foundation built on legacy and emerging technologies, including excellent track record of on-time deliveries. We are emerging as one of the most promising private talent sourcing and management firms in the world. The real challenge before companies in today's world is to make their products and services appealing to everyone.</div>
					<div class="tab-pane fade" id="v-pills-profile" role="tabpanel" aria-labelledby="v-pills-profile-tab">We pride ourselves on the service we give to our clients. Our friendly team members are always willing to help you understand your present technology requirements and provide suggestions on your future needs. It can be the packaging of an item or the design of its website and Applications.</div>
					<div class="tab-pane fade" id="v-pills-messages" role="tabpanel" aria-labelledby="v-pills-messages-tab">Eduport an innovative Internet marketing solutions company that offers comprehensive web development, SMO services, SEO strategies and various other types of Internet marketing related services. With us at your side, you will find the IT solution to achieve your strategic and financial goals.</div>
					<div class="tab-pane fade" id="v-pills-settings" role="tabpanel" aria-labelledby="v-pills-settings-tab">Our friendly team members are always willing to help you understand your present technology requirements and provide suggestions on your future needs. It can be the packaging of an item or the design of its website and Applications. We pride ourselves on the service we give to our clients.</div>
				</div>
			</div>
		</div>
		
	</div>
	<!-- 각 차수 마다 불러올 목록. -->


</div>