<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>

<body>
<main>
<section class="pb-0 py-lg-5">
	<div class="container">
		<div class="row">
			<div class="col-md-4">
				<div class="d-flex justify-content-flex-start">
				<button class="d-flex align-items-center" style="border: solid 1px; background-color: white;" onclick="">
					<i class="bi bi-files">불러오기</i>
				</button>&nbsp;
				<button id="newIntroBtn" class="d-flex align-items-center" style="border: solid 1px; background-color: white;">
					<i class="bi bi-file-earmark-plus">새자소서</i>
				</button>&nbsp;
				<button id="deleteIntroBtn" class="d-flex align-items-center" style="border: solid 1px; background-color: white;" >
					<i class="bi bi-file-earmark-x">삭제</i>
				</button>
			</div>
			</div>
			<div class="col-sm-6" >
				<button class="d-flex align-items-center" style="border: solid 1px; background-color: white;" onclick="">
					<i class="bi bi-save">저장기록</i>
				</button>
			</div>
			<div class="col-sm-2 text-right">
				<div class="d-flex justify-content-end">
				<input type="button"  value="저장">
				</div>
			</div>
			<!-- Main content START -->
			<div class="col-lg-12">
				<div class="card shadow rounded-2 p-0">
					<!-- Tabs START -->
					<div class="card-header border-bottom px-4 py-3">
						<ul class="nav nav-pills nav-tabs-line py-0" id="course-pills-tab" role="tablist">
							<!-- Tab item -->
							<li class="nav-item me-2 me-sm-1" role="presentation">
								<button class="nav-link mb-2 mb-md-0 active" id="course-pills-tab-1" data-bs-toggle="pill" data-bs-target="#course-pills-1" type="button" role="tab" aria-controls="course-pills-1" aria-selected="true">1</button>
							</li>
							<!-- Tab item -->
							<li class="nav-item me-2 me-sm-1" role="presentation">
								<button class="nav-link mb-2 mb-md-0" id="course-pills-tab-2" data-bs-toggle="pill" data-bs-target="#course-pills-2" type="button" role="tab" aria-controls="course-pills-2" aria-selected="false">2</button>
							</li>
							<!-- Tab item -->
							<li class="nav-item me-2 me-sm-1" role="presentation">
								<button class="nav-link mb-2 mb-md-0" id="course-pills-tab-3" data-bs-toggle="pill" data-bs-target="#course-pills-3" type="button" role="tab" aria-controls="course-pills-3" aria-selected="false">3</button>
							</li>
						</ul>
					</div>
					<!-- Tabs END -->

					<!-- Tab contents START -->
					<div class="card-body p-4">
						<div class="tab-content pt-2" id="course-pills-tabContent">
							<!-- Content START -->
							<div class="tab-pane fade show active" id="course-pills-1" role="tabpanel" aria-labelledby="course-pills-tab-1">
								<!-- Course detail START -->
								<h5 class="mb-3">KT SW개발</h5>
								<textarea name="problem" id="problem1" style="width: 100%; overflow: hidden; overflow-wrap: break-word; border: none; resize: none;" cols="auto" rows="5"  
								placeholder="KT의 핵심가치 중 자신에게 가장 부합하는 것을 선택하고, 그 이유를 구체적인 사례와 함께 기술해주십시오." disabled></textarea>
								<div style="text-align: right;">
								<input type="button" value="오류신고" ></input>
								</div>
								<br/><hr/>
								<textarea class="textBox" style="width: 100%; height: 150px; resize: none; border: none;" maxlength="1000" placeholder="답변을 입력하세요"></textarea>
								<!-- Course detail END -->
								<div style="display: flex; align-items: center;">
									<div class="textCount" style="width: 500px;">
									</div>
									<div class="progress progress-percent-bg" style="flex-grow: 1;margin-left: 10px;">
										<div class="progress-bar progress-bar-striped bg-info" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"><span class="progress-percent" style="margin-right: -10px" ></span></div>
									</div>
								</div>
							</div>
							<!-- Content END -->

							<!-- Content START -->
							<div class="tab-pane fade" id="course-pills-2" role="tabpanel" aria-labelledby="course-pills-tab-2">
								<!-- Course detail START -->
								<h5 class="mb-3">제목</h5>
								<textarea name="problem" id="problem2" style="width: 100%; overflow: hidden; overflow-wrap: break-word; border: none; resize: none;" cols="auto" rows="5"  
								placeholder="답변을 입력하세요"></textarea>
								<div style="text-align: right;">
								<input type="button" value="오류신고" ></input>
								</div>
								<br/><hr/>
								<textarea style="width: 100%; height: 150px; resize: vertical; border: none;" placeholder="답변을 입력하세요"></textarea>
								<!-- Course detail END -->
								<div style="display: flex; align-items: center;">
									<div style="width: 500px;">
										0 / 1000 (글자 수, 공백 포함)
									</div>
									<div class="progress progress-percent-bg" style="flex-grow: 1; margin-left: 10px;">
										<div class="progress-bar progress-bar-striped bg-info" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"><span class="progress-percent">80%</span></div>
									</div>
								</div>
							</div>
							<!-- Content END -->

							<!-- Content START -->
							<div class="tab-pane fade" id="course-pills-3" role="tabpanel" aria-labelledby="course-pills-tab-3">
								<!-- Course detail START -->
								<h5 class="mb-3">제목</h5>
								<textarea name="problem" id="problem3" style="width: 100%; overflow: hidden; overflow-wrap: break-word; border: none; resize: none;" cols="auto" rows="5"  
								placeholder="답변을 입력하세요"></textarea>
								<div style="text-align: right;">
								<input type="button" value="오류신고" ></input>
								</div>
								<br/><hr/>
								<textarea style="width: 100%; height: 150px; resize: vertical; border: none;" placeholder="답변을 입력하세요"></textarea>
								<!-- Course detail END -->
								<div style="display: flex; align-items: center;">
									<div style="width: 500px;">
										0 / 1000 (글자 수, 공백 포함)
									</div>
									<div class="progress progress-percent-bg" style="flex-grow: 1; margin-left: 10px;">
										<div class="progress-bar progress-bar-striped bg-info" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"><span class="progress-percent">80%</span></div>
									</div>
								</div>
							</div>
							<!-- Content END -->

						</div>
					</div>
					<!-- Tab contents END -->
				</div>
			</div>
			<!-- Main content END -->


		</div><!-- Row END -->
	</div>
</section>
</main>
</body>
<script>
$(function(){
    var newIntroBtn = $("#newIntroBtn");
    var deleteIntroBtn = $("#deleteIntroBtn");

    newIntroBtn.on("click", function(){
        var tabList = $("#course-pills-tab");
        var tabCounter = tabList.children().length + 1; // 현재 탭 개수 + 1

        // 탭 아이콘 추가
        var newTab = $("<li class='nav-item me-2 me-sm-1' role='presentation'>" +
            "<button class='nav-link mb-2 mb-md-0' id='course-pills-tab-" + tabCounter + "' data-bs-toggle='pill' data-bs-target='#course-pills-" + tabCounter + "' type='button' role='tab' aria-controls='course-pills-" + tabCounter + "' aria-selected='false'>" + tabCounter + "</button>" +
            "</li>");
        tabList.append(newTab);

        // 탭에 해당하는 내용 추가
        var tabContent = $("#course-pills-tabContent");
        var newContent = $("<div class='tab-pane fade' id='course-pills-" + tabCounter + "' role='tabpanel' aria-labelledby='course-pills-tab-" + tabCounter + "'>" +
       	    "<h5 class='mb-3'>제목</h5>" +
       	    "<textarea name='problem' id='problem" + tabCounter + "' style='width: 100%; overflow: hidden; overflow-wrap: break-word; border: none; resize: none;' cols='auto' rows='5' placeholder='답변을 입력하세요'></textarea>" +
       	    "<div style='text-align: right;'>" +
       	    "<input type='button' value='오류신고'>" +
       	    "</div>" +
       	    "<br/><hr/>" +
       	    "<textarea class='textBox' style='width: 100%; height: 150px; resize: none; border: none;' maxlength='1000' placeholder='답변을 입력하세요'></textarea>" +
       	    "<div style='display: flex; align-items: center;'>" +
       	    "<div class='textCount' style='width: 500px;'></div>" +
       	    "<div class='progress progress-percent-bg' style='flex-grow: 1;margin-left: 10px;'>" +
       	    "<div class='progress-bar progress-bar-striped bg-info' role='progressbar' style='width: 50%' aria-valuenow='50' aria-valuemin='0' aria-valuemax='100'><span class='progress-percent' style='margin-right: -10px'></span></div>" +
       	    "</div>" +
       	    "</div>" +
       	    "</div>");
       	tabContent.append(newContent);

        // 새로 추가된 탭 활성화
        newTab.find("button").tab('show');
        initContent();
    });
    
    deleteIntroBtn.on("click", function(){
        var activeTab = $("#course-pills-tab .nav-link.active"); // 현재 활성화된 탭을 찾습니다.
        var tabItem = activeTab.closest("li.nav-item"); // 현재 탭 아이템을 찾습니다.
        var tabId = activeTab.attr("id"); // 활성화된 탭의 ID를 가져옵니다.
        var tabNumber = tabId.substring(tabId.lastIndexOf("-") + 1); // "-" 뒤의 번호를 가져옵니다.
//         console.log("삭제할 탭 번호:", tabNumber);

        // 삭제할 탭과 해당 내용을 삭제합니다.
        $("#course-pills-" + tabNumber).remove(); // 탭 내용 삭제
        tabItem.remove(); // 탭 삭제

        // 삭제된 탭 다음 탭을 활성화합니다.
        var nextTabNumber = parseInt(tabNumber) + 1;
        if (nextTabNumber > 1 && nextTabNumber <= $("#course-pills-tab").children().length) {
            $("#course-pills-tab-" + nextTabNumber).tab("show");
        } else {
            var prevTabNumber = parseInt(tabNumber) - 1;
            if (prevTabNumber >= 1) {
                $("#course-pills-tab-" + prevTabNumber).tab("show");
            }
        }

        // 남은 탭의 번호를 다시 조정합니다.
        $("#course-pills-tab .nav-link").each(function(index){
            $(this).text(index + 1);
            var targetId = $(this).attr("data-bs-target");
            var newTargetId = targetId.replace(/[^-]+$/, index + 1);
            $(this).attr("id", "course-pills-tab-" + (index + 1));
            $(this).attr("data-bs-target", newTargetId);
            $(this).attr("aria-controls", newTargetId);
            $(targetId).attr("id", "course-pills-" + (index + 1));
            $(targetId).attr("aria-labelledby", "course-pills-tab-" + (index + 1));
        });
        initContent();
    });
    
  
    
});

function initContent() {
    $('.textCount').text('0 / 1000 (글자 수, 공백 포함)'); // 텍스트 카운트 초기화
    $('.progress-bar').css('width', '0%'); // 프로그레스 바 초기화
}
$(document).ready(function() {
    // 페이지가 로드될 때 초기값 설정
//     $('#textCount').text('0 / 1000 (글자 수, 공백 포함)'); // 텍스트 카운트 초기화
//     $('.progress-bar').css('width', '0%'); // 프로그레스 바 초기화
    initContent();
    
    // 텍스트 입력 시 이벤트 처리
    $('.textBox').keyup(function (e) {
        let content = $(this).val();
        console.log(content);

        // 글자수 세기
        if (content.length == 0 || content == '') {
            $('.textCount').text('0 / 1000 (글자 수, 공백 포함)');
        } else {
            $('.textCount').text(content.length + ' / 1000 (글자 수, 공백 포함)');
        }

        // 글자수 제한
        if (content.length >= 1000) {
            // 1000자부터는 타이핑이 되지 않도록
            $(this).val(content.substring(0, 1000));
            // 1000자 넘으면 알림창 대신 텍스트 색상을 빨간색으로 변경
            $('.textCount').css('color', 'red');
        } else {
            $('.textCount').css('color', ''); // 기본색상으로 변경
        }

        // 프로그레스 바 너비 설정
        let progressBarWidth = (content.length / 1000) * 100; // 전체 글자 수 1000을 기준으로 너비를 계산
        $('.progress-bar').css('width', progressBarWidth + '%');
        $('.progress-percent').text(Math.floor(progressBarWidth) + '%');
    });
});
</script>

